<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Prefetch</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in § N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *     -> ins/del.c### for candidate and proposed changes (amendments)
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *   - .correction for "candidate corrections"       (div, aside, details, section)
 *   - .addition   for "candidate additions"         (div, aside, details, section)
 *   - .correction.proposed for "proposed corrections" (div, aside, details, section)
 *   - .addition.proposed   for "proposed additions"   (div, aside, details, section)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Outdated warning for old specs
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/* color variables included separately for reliability */

/******************************************************************************/
/*                                    Body                                    */
/******************************************************************************/

	html {
	}

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;			  /* limit line length to 50em for readability   */
		margin: 0 auto;				/* center text within page                    */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag    */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		color: black;
		color: var(--text);
		background: white top left fixed no-repeat;
		background: var(--bg) top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em; }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border: solid var(--logo-bg);
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		background: var(--logo-bg);
		color: white;
		color: var(--logo-text);
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		background: var(--logo-active-bg);
		border-color: #c00;
		border-color: var(--logo-active-bg);
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small; }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 3;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;

			color: #707070;
			color: var(--tocnav-normal-text);
			background: white;
			background: var(--tocnav-normal-bg);
		}
		#toc-nav > a:hover,
		#toc-nav > a:focus {
			color: black;
			color: var(--tocnav-hover-text);
			background: #f8f8f8;
			background: var(--tocnav-hover-bg);
		}
		#toc-nav > a:active {
			color: #c00;
			color: var(--tocnav-active-text);
			background: white;
			background: var(--tocnav-active-bg);
		}

		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;	/* Inherit the font family. */
		line-height: 1.2;		/* Keep wrapped headings compact */
		hyphens: manual;		/* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		color: var(--heading-text);
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#profile-and-date {
		/* #profile-and-date is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > :not(.head) + hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		color: black;
		color: var(--hr-text);
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	border-left: 0.5em solid #DEF;
	border-left: 0.5em solid var(--algo-border);
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	 padding: .5em;
	 border: thin solid #ddd;
	 border: thin solid var(--algo-border);
	 border-radius: .5em;
	 margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	 margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	 margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	margin-left: -2em;
	}
	dl.switch {
	padding-left: 2em;
	}
	dl.switch > dt {
	text-indent: -1.5em;
	margin-top: 1em;
	}
	dl.switch > dt + dt {
	margin-top: 0;
	}
	dl.switch > dt::before {
	content: '\21AA';
	padding: 0 0.5em 0 0;
	display: inline-block;
	width: 1em;
	text-align: right;
	line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del {
		color: #aa0000;
		color: var(--del-text);
		background: transparent;
		background: var(--del-bg);
		text-decoration: line-through;
	}
	ins {
		color: #006100;
		color: var(--ins-text);
		background: transparent;
		background: var(--ins-bg);
		text-decoration: underline;
	}

	/* for amendments (candidate/proposed changes) */

	.amendment ins, .correction ins, .addition ins,
	ins[class^=c] {
		text-decoration-style: dotted;
	}
	.amendment del, .correction del, .addition del,
	del[class^=c] {
		text-decoration-style: dotted;
	}
	.amendment.proposed ins, .correction.proposed ins, .addition.proposed ins,
	ins[class^=c].proposed {
		text-decoration-style: double;
	}
	.amendment.proposed del, .correction.proposed del, .addition.proposed del,
	del[class^=c].proposed {
		text-decoration-style: double;
	}

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		hyphens: none;
		text-transform: none;
		text-align: left;
		text-align: start;
		font-variant: normal;
		orphans: 3;
		widows: 3;
		page-break-before: avoid;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

	/* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		color: var(--a-normal-text);
		text-decoration: underline #707070;
		text-decoration: underline var(--a-normal-underline);
		text-decoration-skip-ink: none;
	}
	a:visited {
		color: #034575;
		color: var(--a-visited-text);
		text-decoration-color: #bbb;
		text-decoration-color: var(--a-visited-underline);
	}

	/* Indicate interaction with the link */
	a[href]:focus,
	a[href]:hover {
		text-decoration-thickness: 2px;
	}
	a[href]:active {
		color: #c00;
		color: var(--a-active-text);
		text-decoration-color: #c00;
		text-decoration-color: var(--a-active-underline);
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	img, svg {
		/* Intentionally not color-scheme aware. */
		background: white;
	}

	/* For autogen numbers, add
	  .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,	.sidefigure img,	figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
		height: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em;
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em; }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote,
	.amendment, .correction, .addition {
		margin: 1em auto;
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	blockquote > :first-child,
	.note  > p:first-child,
	.issue > p:first-child,
	.amendment > p:first-child,
	.correction > p:first-child,
	.addition > p:first-child {
		margin-top: 0;
	}
	blockquote > :last-child,
	.note  > p:last-child,
	.issue > p:last-child,
	.amendment > p:last-child,
	.correction > p:last-child,
	.addition > p:last-child {
		margin-bottom: 0;
	}


	.issue::before, .issue > .marker,
	.example::before, .example > .marker,
	.note::before, .note > .marker,
	details.note > summary > .marker,
	.amendment::before, .amendment > .marker,
	details.amendment > summary > .marker,
	.addition::before, .addition > .marker,
	addition.amendment > summary > .marker,
	.correction::before, .correction > .marker,
	correction.amendment > summary > .marker
	{
		text-transform: uppercase;
		padding-right: 1em;
	}

	.example::before, .example > .marker {
		display: block;
		padding-right: 0em;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
		border-color: var(--blockquote-border);
		background: transparent;
		background: var(--blockquote-bg);
		color: currentcolor;
		color: var(--blockquote-text);
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #e05252;
		border-color: var(--issue-border);
		background: #fbe9e9;
		background: var(--issue-bg);
		color: black;
		color: var(--issue-text);
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		color: #831616;
		color: var(--issueheading-text);
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	  or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #e0cb52;
		border-color: var(--example-border);
		background: #fcfaee;
		background: var(--example-bg);
		color: black;
		color: var(--example-text);
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		color: #574b0f;
		color: var(--exampleheading-text);
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	  or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52e052;
		border-color: var(--note-border);
		background: #e9fbe9;
		background: var(--note-bg);
		color: black;
		color: var(--note-text);
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary {
		color: hsl(120, 70%, 30%);
		color: var(--noteheading-text);
	}
	/* Add .note::before { content: "Note "; } for autogen label,
	  or use class="marker" to mark up the label in source. */

	details.note[open] > summary {
		border-bottom: 1px silver solid;
		border-bottom: 1px var(--notesummary-underline) solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		border-color: var(--assertion-border);
		background: #EEE;
		background: var(--assertion-bg);
		color: black;
		color: var(--assertion-text);
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-color: var(--advisement-border);
		border-style: none solid;
		background: #fec;
		background: var(--advisement-bg);
		color: black;
		color: var(--advisement-text);
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement::before, .advisement > .marker {
		color: #b35f00;
		color: var(--advisementheading-text);
	}

/** Amendment Box *************************************************************/

	.amendment, .correction, .addition {
		border-color: #330099;
		border-color: var(--amendment-border);
		background: #F5F0FF;
		background: var(--amendment-bg);
		color: black;
		color: var(--amendment-text);
	}
	.amendment.proposed, .correction.proposed, .addition.proposed {
		border-style: solid;
		border-block-width: 0.25em;
	}
	.amendment::before, .amendment > .marker,
	details.amendment > summary::before, details.amendment > summary > .marker,
	.correction::before, .correction > .marker,
	details.correction > summary::before, details.correction > summary > .marker,
	.addition::before, .addition > .marker,
	details.addition > summary::before, details.addition > summary > .marker {
		color: #220066;
		color: var(--amendmentheading-text);
	}
	.amendment.proposed::before, .amendment.proposed > .marker,
	details.amendment.proposed > summary::before, details.amendment.proposed > summary > .marker,
	.correction.proposed::before, .correction.proposed > .marker,
	details.correction.proposed > summary::before, details.correction.proposed > summary > .marker,
	.addition.proposed::before, .addition.proposed > .marker,
	details.addition.proposed > summary::before, details.addition.proposed > summary > .marker {
		font-weight: bold;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: hsla(40,100%,50%,0.95);
		background: var(--warning-bg);
		color: black;
		color: var(--warning-text);
		padding: .75em 1em;
		border: red;
		border: var(--warning-border);
		border-style: solid none;
		box-shadow: 0 2px 8px black;
		text-align: center;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 0;
		right: 0;
		bottom: 2em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #def;
		background: var(--def-bg);
		margin: 1.2em 0;
		border-left: 0.5em solid #8ccbf2;
		border-left: 0.5em solid var(--def-border);
		color: black;
		color: var(--def-text);
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
		border-bottom: 1px solid var(--defrow-border);
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def td.footnote {
		padding-top: 0.6em;
	}
	table.def td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		<table class="data"> highlights structural relationships in a table
		when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		Use class="complex data" for particularly complicated tables --
		(This will draw more lines: busier, but clearer.)

		Use class="long" on table cells with paragraph-like contents
		(This will adjust text alignment accordingly.)
		Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-color: var(--datacell-border);
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		border-top: 1px solid var(--datacell-border);
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		border: 1px solid var(--datacell-border);
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
		vertical-align: baseline;
		text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding: 0.1rem 1px 0;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Switch to using border-bottom for underlines */
		text-decoration: none;
		border-bottom: 1px solid;
		/* Reverse color scheme */
		color: black;
		color: var(--toclink-text);
		border-color: #3980b5;
		border-color: var(--toclink-underline);
	}
	.toc a:visited {
		color: black;
		color: var(--toclink-visited-text);
		border-color: #054572;
		border-color: var(--toclink-visited-underline);
	}
	.toc a:focus,
	.toc a:hover {
		background: rgba(75%, 75%, 75%, .25);
		background: var(--a-hover-bg);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
	}
	.toc {
		line-height: 1.1em;
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li			{ font-weight: bold;   }
	.toc > li li		 { font-weight: normal; }
	.toc > li li li	  { font-size:   95%;	}
	.toc > li li li li	{ font-size:   90%;	}
	.toc > li li li li li { font-size:   85%;	}

	/* @supports not (display:grid) { */
		.toc > li			{ margin: 1.5rem 0;	}
		.toc > li li		 { margin: 0.3rem 0;	}
		.toc > li li li	  { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}
		.toc > li li li li .secno { font-size: 85%; }
		.toc > li li li li li .secno { font-size: 100%; }

		.toc li {
			clear: both;
		}

		:not(li) > .toc			 { margin-left:  5rem; }
		.toc .secno				 { margin-left: -5rem; }
		.toc > li li li .secno	  { margin-left: -7rem; }
		.toc > li li li li .secno	{ margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc			 { margin-left:  4rem; }
			.toc .secno				 { margin-left: -4rem; }
			.toc > li li li			 { margin-left:  1rem; }
			.toc > li li li .secno	  { margin-left: -5rem; }
			.toc > li li li li .secno	{ margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
		/* Loosen it on wide screens */
		@media screen and (min-width: 78em) {
			body:not(.toc-inline) :not(li) > .toc			 { margin-left:  4rem; }
			body:not(.toc-inline) .toc .secno				 { margin-left: -4rem; }
			body:not(.toc-inline) .toc > li li li			 { margin-left:  1rem; }
			body:not(.toc-inline) .toc > li li li .secno	  { margin-left: -5rem; }
			body:not(.toc-inline) .toc > li li li li .secno	{ margin-left: -6rem; }
			body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	/* } */

	@supports (display:grid) and (display:contents) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			  comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc#toc .secno { /* Ugh, need more specificity to override base.css */
			grid-column: 1;
			width: auto;
			margin-left: 0;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
		}
		#toc .content:hover,
		#toc .content:focus {
			background: rgba(75%, 75%, 75%, .25);
			background: var(--a-hover-bg);
			border-bottom: 3px solid #054572;
			border-bottom: 3px solid var(--toclink-underline);
			margin-bottom: -3px;
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index	  { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li	{ margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em; }
	ul.index dl	{ margin-top: 0; }
	ul.index dt	{ margin: .2em 0 .2em 20px;}
	ul.index dd	{ margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span:not(.dfn-paneled) {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
			color: var(--indexinfo-text);
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		color: black;
		color: var(--indextable-hover-text);
		background: #f7f8f9;
		background: var(--indextable-hover-bg);
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/** Outdated warning **********************************************************/

.outdated-spec {
	color: black;
	color: var(--outdatedspec-text);
	background-color: rgba(0,0,0,0.5);
	background-color: var(--outdatedspec-bg);
}

.outdated-warning {
	position: fixed;
	bottom: 50%;
	left: 0;
	right: 0;
	margin: 0 auto;
	width: 50%;
	background: maroon;
	background: var(--outdated-bg);
	color: white;
	color: var(--outdated-text);
	border-radius: 1em;
	box-shadow: 0 0 1em red;
	box-shadow: 0 0 1em var(--outdated-shadow);
	padding: 2em;
	text-align: center;
	z-index: 2;
}

.outdated-warning a {
	color: currentcolor;
	background: transparent;
}

.edited-rec-warning {
	background: darkorange;
	background: var(--editedrec-bg);
	box-shadow: 0 0 1em;
}

.outdated-warning button {
	color: var(--outdated-text);
	border-radius: 1em;
	box-shadow: 0 0 1em red;
	box-shadow: 0 0 1em var(--outdated-shadow);
	padding: 2em;
	text-align: center;
	z-index: 2;
}

.outdated-warning a {
	color: currentcolor;
	background: transparent;
}

.edited-rec-warning {
	background: darkorange;
	background: var(--editedrec-bg);
	box-shadow: 0 0 1em;
}

.outdated-warning button {
	position: absolute;
	top: 0;
	right:0;
	margin: 0;
	border: 0;
	padding: 0.25em 0.5em;
	background: transparent;
	color: white;
	color: var(--outdated-text);
	font:1em sans-serif;
	text-align:center;
}

.outdated-warning span {
	display: block;
}

.outdated-collapsed {
	bottom: 0;
	border-radius: 0;
	width: 100%;
	padding: 0;
}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}

		.outdated-warning {
			position: absolute;
			border-style: solid;
			border-color: red;
		}

		.outdated-warning input {
			display: none;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge {
		/* Magic to create good item positioning:
		  "content column" is 50ems wide at max; less on smaller screens.
		  Extra space (after ToC + content) is empty on the right.

		  1. When item < content column, centers item in column.
		  2. When content < item < available, left-aligns.
		  3. When item > available, fills available + scroll bar.
		*/
		display: grid;
		grid-template-columns: minmax(0, 50em);
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			* http://lea.verou.me/2012/04/background-attachment-local/
			*
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
						top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
						top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
						top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
						white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed version d7036035b, updated Fri Oct 8 17:07:11 2021 -0700" name="generator">
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-dfn-panel */

:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-issues */

a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-var-click-highlighting */

    var { cursor: pointer; }
    var.selected0 { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
    var.selected1 { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
    var.selected2 { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
    var.selected3 { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
    var.selected4 { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
    var.selected5 { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
    var.selected6 { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
    </style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">Prefetch</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="profile-and-date"><span class="content">A Collection of Interesting Ideas, <time class="dt-updated" datetime="2021-10-27">27 October 2021</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/jeremyroman/alternate-loading-modes/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:jbroman@chromium.org">Jeremy Roman</a> (<a class="p-org org" href="https://www.google.com/">Google</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://creativecommons.org/publicdomain/zero/1.0/" rel="license"><img alt="CC0" height="15" src="https://licensebuttons.net/p/zero/1.0/80x15.png" width="80"></a> To the extent possible under law, the editors have waived all copyright
and related or neighboring rights to this work.
In addition, as of 27 October 2021,
the editors have made this specification available under the <a href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0" rel="license">Open Web Foundation Agreement Version 1.0</a>,
which is available at http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0.
Parts of this work may be from another specification document.  If so, those parts are instead covered by the license of that specification document. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>Extensions to WHATWG Fetch for prefetching with partitioning in mind.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#concepts"><span class="secno">1</span> <span class="content">Concepts</span></a>
    <li><a href="#html-patches"><span class="secno">2</span> <span class="content">HTML Patches</span></a>
    <li><a href="#prefetch-algorithms"><span class="secno">3</span> <span class="content">Prefetch algorithms</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="concepts"><span class="secno">1. </span><span class="content">Concepts</span><a class="self-link" href="#concepts"></a></h2>
   <p>In light of <a href="https://privacycg.github.io/storage-partitioning/">storage partitioning</a>, this specification defines prefetch for navigations which would occur within the same partition (for example, top-level navigations within the same site) and for navigations which would occur in a separate partition (for example, top-level navigations to a different site).</p>
   <p>Each <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="prefetch-buffer">prefetch buffer</dfn>, which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a> of <a data-link-type="dfn" href="#prefetch-record" id="ref-for-prefetch-record">prefetch records</a>.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="prefetch-record">prefetch record</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">struct</a> with the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item">items</a>:</p>
   <ul>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="prefetch record" data-dfn-type="dfn" data-export id="prefetch-record-url">URL</dfn>, a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">URL</a></p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="prefetch record" data-dfn-type="dfn" data-export id="prefetch-record-referrer-policy">referrer policy</dfn>, a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-referrer-policy/#referrer-policy" id="ref-for-referrer-policy">referrer policy</a></p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="prefetch record" data-dfn-type="dfn" data-export id="prefetch-record-response">response</dfn>, a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response">response</a></p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="prefetch record" data-dfn-type="dfn" data-export id="prefetch-record-expiry-time">expiry time</dfn>, a <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/hr-time-2/#dom-domhighrestimestamp" id="ref-for-dom-domhighrestimestamp">DOMHighResTimeStamp</a></code></p>
   </ul>
   <p class="issue" id="issue-794936c7"><a class="self-link" href="#issue-794936c7"></a>Does the prefetch record need to contain redirect info, e.g. to verify that all redirects would pass <code>navigate-to</code>?</p>
   <p>The user agent may remove elements from the <a data-link-type="dfn" href="#prefetch-buffer" id="ref-for-prefetch-buffer">prefetch buffer</a> even if they are not expired, e.g., due to resource constraints. Since records with expiry times in the past are never returned, they can be removed with no observable consequences.</p>
   <div class="algorithm" data-algorithm="store a prefetch record">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="store-a-prefetch-record">store a prefetch record</dfn> given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①">Document</a></code> <var>document</var>, <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①">URL</a> <var>url</var>, <a data-link-type="dfn" href="https://w3c.github.io/webappsec-referrer-policy/#referrer-policy" id="ref-for-referrer-policy①">referrer policy</a> <var>referrerPolicy</var> and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①">response</a> <var>response</var>, perform the following steps. 
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert">Assert</a>: <var>document</var> is <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#fully-active" id="ref-for-fully-active">fully active</a>.</p>
     <li data-md>
      <p>Let <var>currentTime</var> be the <a data-link-type="dfn" href="https://www.w3.org/TR/hr-time-2/#dfn-current-high-resolution-time" id="ref-for-dfn-current-high-resolution-time">current high resolution time</a> for the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global">relevant global object</a> of <var>document</var>.</p>
     <li data-md>
      <p>Let <var>expiryTime</var> be <var>currentTime</var> + 300000 (i.e., five minutes).</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove">Remove</a> all elements whose <a data-link-type="dfn" href="#prefetch-record-url" id="ref-for-prefetch-record-url">URL</a> equals <var>url</var> and <a data-link-type="dfn" href="#prefetch-record-referrer-policy" id="ref-for-prefetch-record-referrer-policy">referrer policy</a> equals <var>referrerPolicy</var> from <var>document</var>’s <a data-link-type="dfn" href="#prefetch-buffer" id="ref-for-prefetch-buffer①">prefetch buffer</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append">Append</a> a <a data-link-type="dfn" href="#prefetch-record" id="ref-for-prefetch-record①">prefetch record</a> with <a data-link-type="dfn" href="#prefetch-record-url" id="ref-for-prefetch-record-url①">URL</a> <var>url</var>, <a data-link-type="dfn" href="#prefetch-record-referrer-policy" id="ref-for-prefetch-record-referrer-policy①">referrer policy</a> <var>referrerPolicy</var>, <a data-link-type="dfn" href="#prefetch-record-response" id="ref-for-prefetch-record-response">response</a> <var>response</var> and <a data-link-type="dfn" href="#prefetch-record-expiry-time" id="ref-for-prefetch-record-expiry-time">expiry time</a> <var>expiryTime</var> to <var>document</var>’s <a data-link-type="dfn" href="#prefetch-buffer" id="ref-for-prefetch-buffer②">prefetch buffer</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="find a matching prefetch response">
     To <dfn data-dfn-type="dfn" data-export id="find-a-matching-prefetch-response">find a matching prefetch response<a class="self-link" href="#find-a-matching-prefetch-response"></a></dfn> given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②">Document</a></code> <var>document</var>, <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url②">URL</a> <var>url</var> and <a data-link-type="dfn" href="https://w3c.github.io/webappsec-referrer-policy/#referrer-policy" id="ref-for-referrer-policy②">referrer policy</a> <var>referrerPolicy</var>, perform the following steps. 
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①">Assert</a>: <var>document</var> is <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#fully-active" id="ref-for-fully-active①">fully active</a>.</p>
     <li data-md>
      <p>Let <var>currentTime</var> be the <a data-link-type="dfn" href="https://www.w3.org/TR/hr-time-2/#dfn-current-high-resolution-time" id="ref-for-dfn-current-high-resolution-time①">current high resolution time</a> for the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global①">relevant global object</a> of <var>document</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate">For each</a> <var>record</var> of <var>document</var>’s <a data-link-type="dfn" href="#prefetch-buffer" id="ref-for-prefetch-buffer③">prefetch buffer</a>:</p>
      <ol>
       <li data-md>
        <p>If <var>record</var>’s <a data-link-type="dfn" href="#prefetch-record-url" id="ref-for-prefetch-record-url②">URL</a> is not equal to <var>url</var> or <var>record</var>’s <a data-link-type="dfn" href="#prefetch-record-referrer-policy" id="ref-for-prefetch-record-referrer-policy②">referrer policy</a> is not equal to <var>referrerPolicy</var>, then <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue">continue</a>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove①">Remove</a> <var>record</var> from <var>document</var>’s <a data-link-type="dfn" href="#prefetch-buffer" id="ref-for-prefetch-buffer④">prefetch buffer</a>.</p>
       <li data-md>
        <p>If <var>record</var>’s <a data-link-type="dfn" href="#prefetch-record-expiry-time" id="ref-for-prefetch-record-expiry-time①">expiry time</a> is less than <var>currentTime</var>, return null.</p>
       <li data-md>
        <p>Return <var>record</var>’s <a data-link-type="dfn" href="#prefetch-record-response" id="ref-for-prefetch-record-response①">response</a>.</p>
      </ol>
     <li data-md>
      <p>Return null.</p>
    </ol>
    <p class="issue" id="issue-34917491"><a class="self-link" href="#issue-34917491"></a>It might be possible to use cache response headers to determine when a response can be used multiple times, but given the short lifetime of the prefetch buffer it’s unclear whether this is worthwhile.</p>
   </div>
   <h2 class="heading settled" data-level="2" id="html-patches"><span class="secno">2. </span><span class="content">HTML Patches</span><a class="self-link" href="#html-patches"></a></h2>
   <div class="algorithm" data-algorithm="perform a common navigational fetch">
    <div class="note" role="note">This is an abstraction of the existing <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch" id="ref-for-process-a-navigate-fetch">process a navigate fetch</a>. It includes behavior like redirect handling that is particular to navigational fetches, including those that are relate to a speculate future navigation, rather than an immediate one.</div>
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="perform-a-common-navigational-fetch">perform a common navigational fetch</dfn> given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">request</a> <var>request</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string">string</a> <var>navigationType</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context" id="ref-for-browsing-context">browsing context</a> <var>browsingContext</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment" id="ref-for-environment">environment</a> or null <var>forceEnvironment</var>, algorithm <var>preRedirectHook</var> (which takes <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url③">URLs</a> currentURL and locationURL) algorithm <var>shouldBlockNavigationRequest</var> (which takes a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①">request</a>, navigation type <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①">string</a>, and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment" id="ref-for-environment①">environment</a>, and returns "<code>Blocked</code>" or "<code>Allowed</code>"), algorithm <var>shouldBlockNavigationResponse</var> (which takes a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②">request</a> and a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②">response</a>, and returns "<code>Blocked</code>" or "<code>Allowed</code>"), perform the following steps.</p>
    <ol>
     <li data-md>
      <p>Let <var>response</var> be null.</p>
     <li data-md>
      <p>Set <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-mode" id="ref-for-concept-request-mode">mode</a> to "<code>navigate</code>" and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-redirect-mode" id="ref-for-concept-request-redirect-mode">redirect mode</a> to "<code>manual</code>".</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert②">Assert</a>: <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-reserved-client" id="ref-for-concept-request-reserved-client">reserved client</a> is null.</p>
     <li data-md>
      <p>Let <var>environment</var> be null.</p>
     <li data-md>
      <p>Let <var>locationURL</var> be null.</p>
     <li data-md>
      <p>Let <var>currentURL</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url">current URL</a>.</p>
     <li data-md>
      <p>While true:</p>
      <ol>
       <li data-md>
        <p>If <var>locationURL</var> is non-null, then:</p>
        <ol>
         <li data-md>
          <p>Run <var>preRedirectHook</var> given <var>currentURL</var> and <var>locationURL</var>.</p>
         <li data-md>
          <p>Set <var>currentURL</var> to <var>locationURL</var>.</p>
        </ol>
       <li data-md>
        <p>If <var>environment</var> is not null and <var>currentURL</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin">origin</a> is not the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin" id="ref-for-same-origin">same</a> as <var>environment</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url" id="ref-for-concept-environment-creation-url">creation URL</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin①">origin</a>, then:</p>
        <ol>
         <li data-md>
          <p>Run the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-discarding-steps" id="ref-for-environment-discarding-steps">environment discarding steps</a> for <var>environment</var>.</p>
         <li data-md>
          <p>Set <var>environment</var> to null.</p>
        </ol>
       <li data-md>
        <p>If <var>environment</var> is null, then:</p>
        <ol>
         <li data-md>
          <p>Let <var>topLevelCreationURL</var> be <var>currentURL</var>.</p>
         <li data-md>
          <p>Let <var>topLevelOrigin</var> be null.</p>
         <li data-md>
          <p>If <var>browsingContext</var> is not a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context" id="ref-for-top-level-browsing-context">top-level browsing context</a>, then:</p>
          <ol>
           <li data-md>
            <p>Let <var>parentEnvironment</var> be <var>browsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#bc-container" id="ref-for-bc-container">container</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object">relevant settings object</a>.</p>
           <li data-md>
            <p>Set <var>topLevelCreationURL</var> to <var>parentEnvironment</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-creation-url" id="ref-for-concept-environment-top-level-creation-url">top-level creation URL</a> and <var>topLevelOrigin</var> to <var>parentEnvironment</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin" id="ref-for-concept-environment-top-level-origin">top-level origin</a>.</p>
          </ol>
         <li data-md>
          <p>Set <var>environment</var> to a new <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment" id="ref-for-environment②">environment</a> whose <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-id" id="ref-for-concept-environment-id">id</a> is a unique opaque string, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context">target browsing context</a> is <var>browsingContext</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url" id="ref-for-concept-environment-creation-url①">creation URL</a> is <var>currentURL</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-creation-url" id="ref-for-concept-environment-top-level-creation-url①">top-level creation URL</a> is <var>topLevelCreationURL</var>, and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin" id="ref-for-concept-environment-top-level-origin①">top-level origin</a> is <var>topLevelOrigin</var>.</p>
         <li data-md>
          <p>If <var>forceEnvironment</var> is null, set <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-reserved-client" id="ref-for-concept-request-reserved-client①">reserved client</a> to <var>environment</var>.</p>
         <li data-md>
          <p>Otherwise, set <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-reserved-client" id="ref-for-concept-request-reserved-client②">reserved client</a> to <var>forceEnvironment</var>.</p>
        </ol>
        <div class="note" role="note">These steps ensure that <var>environment</var> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment" id="ref-for-environment③">environment</a> which the correct <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#network-partition-key" id="ref-for-network-partition-key">network partition key</a>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker" id="ref-for-concept-environment-active-service-worker">active service worker</a>, etc., depending on whether it’s a top-level navigation and if not, what the top-level site is.</div>
       <li data-md>
        <p>If the result of <var>shouldBlockNavigationRequest</var> given <var>request</var>, <var>navigationType</var>, and <var>environment</var> is "<code>Blocked</code>", then set <var>response</var> to a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error">network error</a> and <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-break" id="ref-for-iteration-break">break</a>.</p>
       <li data-md>
        <p>If <var>response</var> is null, <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch">fetch</a> <var>request</var>.</p>
       <li data-md>
        <p>Otherwise, perform <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-redirect-fetch" id="ref-for-concept-http-redirect-fetch">HTTP-redirect fetch</a> using <var>request</var> and <var>response</var>.</p>
       <li data-md>
        <p>Wait for the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" id="ref-for-concept-task">task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#networking-task-source" id="ref-for-networking-task-source">networking task source</a> to <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#process-response" id="ref-for-process-response">process response</a> and set <var>response</var> to the result.</p>
       <li data-md>
        <p>If the result of <var>shouldBlockNavigationResponse</var> given <var>request</var> and <var>response</var> is "<code>Blocked</code>", then set <var>response</var> to a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error①">network error</a> and <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-break" id="ref-for-iteration-break①">break</a>.</p>
       <li data-md>
        <p>Set <var>locationURL</var> to <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-location-url" id="ref-for-concept-response-location-url">location URL</a> given <var>currentURL</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-fragment" id="ref-for-concept-url-fragment">fragment</a>.</p>
       <li data-md>
        <p>If <var>locationURL</var> is not a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url④">URL</a> whose <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme">scheme</a> is an <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-scheme" id="ref-for-http-scheme">HTTP(S) scheme</a>, the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-break" id="ref-for-iteration-break②">break</a>.</p>
        <div class="note" role="note">
          By the end of this loop we will be in one of these scenarios: 
         <ul>
          <li data-md>
           <p><var>response</var> is a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error②">network error</a>.</p>
          <li data-md>
           <p><var>locationURL</var> is failure, because of an unparseable <code>`Location`</code> header.</p>
          <li data-md>
           <p><var>locationURL</var> is null, because we successfully fetched a non-<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error③">network error</a> HTTP(S) response with no <code>`Location`</code> header.</p>
          <li data-md>
           <p><var>locationURL</var> is a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑤">URL</a> with a non-<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-scheme" id="ref-for-http-scheme①">HTTP(S) scheme</a>.</p>
         </ul>
        </div>
      </ol>
     <li data-md>
      <p>If <var>forceEnvironment</var> is not null, run the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-discarding-steps" id="ref-for-environment-discarding-steps①">environment discarding steps</a> for <var>environment</var>.</p>
     <li data-md>
      <p>Return (<var>response</var>, <var>locationURL</var>).</p>
    </ol>
   </div>
   <p>Given this, the non-prefetch case becomes:</p>
   <div class="algorithm" data-algorithm="process a navigate fetch">
     To <strong>process a navigate fetch</strong>, given a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-id" id="ref-for-navigation-id">navigation id</a> <var>navigationId</var>, <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③">request</a> <var>request</var>, two <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context" id="ref-for-browsing-context①">browsing contexts</a> <var>sourceBrowsingContext</var> and <var>browsingContext</var>, a string <var>navigationType</var>, a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#sandboxing-flag-set" id="ref-for-sandboxing-flag-set">sandboxing flag set</a> <var>sandboxFlags</var>, two <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#policy-container" id="ref-for-policy-container">policy containers</a> <var>historyPolicyContainer</var> and <var>initiatorPolicyContainer</var>, a boolean <var>allowedToDownload</var>, a boolean <var>hasTransientActivation</var>, an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin">origin</a> <var>incumbentNavigationOrigin</var>, and a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#history-handling-behavior" id="ref-for-history-handling-behavior">history handling behavior</a> <var>historyHandling</var>: 
    <ol>
     <li data-md>
      <p>Set <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④">request</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client">client</a> to <var>sourceBrowsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#active-document" id="ref-for-active-document">active document</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①">relevant settings object</a>, <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination">destination</a> to "<code>document</code>", <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-credentials-mode" id="ref-for-concept-request-credentials-mode">credentials mode</a> to "<code>include</code>", <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-use-url-credentials-flag" id="ref-for-concept-request-use-url-credentials-flag">use-URL-credentials flag</a>, and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-replaces-client-id" id="ref-for-concept-request-replaces-client-id">replaces client id</a> to <var>browsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#active-document" id="ref-for-active-document①">active document</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object②">relevant settings object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-id" id="ref-for-concept-environment-id①">id</a>.</p>
     <li data-md>
      <p>If <var>hasTransientActivation</var> is true, then set <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#request-user-activation" id="ref-for-request-user-activation">user-activation</a> to true.</p>
     <li data-md>
      <p>If <var>browsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#bc-container" id="ref-for-bc-container①">container</a> is non-null:</p>
      <ol>
       <li data-md>
        <p>If <var>browsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#bc-container" id="ref-for-bc-container②">container</a> has a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-scope-origin" id="ref-for-browsing-context-scope-origin">browsing context scope origin</a>, then set <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin">origin</a> to that <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-scope-origin" id="ref-for-browsing-context-scope-origin①">browsing context scope origin</a>.</p>
       <li data-md>
        <p>Set <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination①">destination</a> to <var>browsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#bc-container" id="ref-for-bc-container③">container</a>'s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-element-local-name" id="ref-for-concept-element-local-name">local name</a>.</p>
      </ol>
     <li data-md>
      <p>Let <var>responseOrigin</var> be null.</p>
     <li data-md>
      <p>Let <var>responseCOOP</var> be null.</p>
     <li data-md>
      <p>Let <var>currentContextIsSource</var> be the result of whether <var>browsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#active-document" id="ref-for-active-document②">active document</a> is <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin" id="ref-for-same-origin①">same origin</a> with <var>sourceBrowsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#active-document" id="ref-for-active-document③">active document</a>.</p>
     <li data-md>
      <p>Let <var>coopEnforcementResult</var> be a new <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-result" id="ref-for-coop-enforcement-result">cross-origin opener policy enforcement result</a> whose <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-bcg-switch" id="ref-for-coop-enforcement-bcg-switch">needs a browsing context group switch</a> is false, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-bcg-switch-report-only" id="ref-for-coop-enforcement-bcg-switch-report-only">would need a browsing context group switch due to report-only</a> is false, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-url" id="ref-for-coop-enforcement-url">url</a> is <var>browsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#active-document" id="ref-for-active-document④">active document</a>'s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-url" id="ref-for-concept-document-url">url</a>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-origin" id="ref-for-coop-enforcement-origin">current origin</a> is <var>browsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#active-document" id="ref-for-active-document⑤">active document</a>'s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-origin" id="ref-for-concept-document-origin">origin</a>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-coop" id="ref-for-coop-enforcement-coop">cross-origin opener policy</a> is <var>browsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#active-document" id="ref-for-active-document⑥">active document</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-document-coop" id="ref-for-concept-document-coop">cross-origin opener policy</a>, and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-source" id="ref-for-coop-enforcement-source">current context is navigation source</a> is <var>currentContextIsSource</var>.</p>
     <li data-md>
      <p>Let <var>finalSandboxFlags</var> be an empty <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#sandboxing-flag-set" id="ref-for-sandboxing-flag-set①">sandboxing flag set</a>.</p>
     <li data-md>
      <p>Let <var>hasCrossOriginRedirects</var> be false.</p>
     <li data-md>
      <p>Let <var>preRedirectHook</var> be the following steps, given <var>currentURL</var> and <var>locationURL</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>locationURL</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin②">origin</a> is not the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin" id="ref-for-same-origin②">same</a> as <var>currentURL</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin③">origin</a>, then set <var>hasCrossOriginRedirects</var> to true.</p>
      </ol>
     <li data-md>
      <p>Let <var>shouldBlockNavigationRequest</var> be the following steps, given <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤">request</a> <var>request</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②">string</a> <var>navigationType</var> and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment" id="ref-for-environment④">environment</a> <var>environment</var>:</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert③">Assert</a>: <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-reserved-client" id="ref-for-concept-request-reserved-client③">reserved client</a> is <var>environment</var>.</p>
       <li data-md>
        <p>Return the result of <a data-link-type="dfn" href="https://w3c.github.io/webappsec-csp/#should-block-navigation-request" id="ref-for-should-block-navigation-request">Should navigation request of type be blocked by Content Security Policy?</a>, given <var>request</var> and <var>navigationType</var>.</p>
      </ol>
     <li data-md>
      <p>Let <var>shouldBlockNavigationResponse</var> be the following steps, given <var>request</var> and <var>response</var>:</p>
      <ol>
       <li data-md>
        <p>Set <var>finalSandboxFlags</var> to the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-union" id="ref-for-set-union">union</a> of <var>browsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-bc-sandboxing-flags" id="ref-for-concept-bc-sandboxing-flags">sandboxing flags</a> and <var>response</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#forced-sandboxing-flag-set" id="ref-for-forced-sandboxing-flag-set">forced sandboxing flag set</a>.</p>
       <li data-md>
        <p>Set <var>responseOrigin</var> to the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#determining-the-origin" id="ref-for-determining-the-origin">determining the origin</a> given <var>browsingContext</var>, <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url">URL</a>, <var>finalSandboxFlags</var>, and <var>incumbentNavigationOrigin</var>.</p>
       <li data-md>
        <p>If <var>browsingContext</var> is a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context" id="ref-for-top-level-browsing-context①">top-level browsing context</a>, then:</p>
        <ol>
         <li data-md>
          <p>Set <var>responseCOOP</var> to the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#obtain-coop" id="ref-for-obtain-coop">obtaining a cross-origin opener policy</a> given <var>response</var> and <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-reserved-client" id="ref-for-concept-request-reserved-client④">reserved client</a>.</p>
         <li data-md>
          <p>If <var>sandboxFlags</var> is not empty and <var>responseCOOP</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#coop-struct-value" id="ref-for-coop-struct-value">value</a> is not "<code>unsafe-none</code>", then return "<code>Blocked</code>".</p>
          <div class="note" role="note">This results in a network error as one cannot simultaneously provide a clean slate to a response using cross-origin opener policy and sandbox the result of navigating to that response.</div>
         <li data-md>
          <p>Set <var>coopEnforcementResult</var> to the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforce" id="ref-for-coop-enforce">enforcing a response’s cross-origin opener policy</a> given <var>browsingContext</var>, <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url①">URL</a>, <var>finalSandboxFlags</var>, and <var>incumbentNavigationOrigin</var>.</p>
          <div class="issue" id="issue-b4469747"><a class="self-link" href="#issue-b4469747"></a>Is COOP enforcement needed on the prefetch path, too?</div>
        </ol>
       <li data-md>
        <p>If <var>response</var> is not a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error④">network error</a>, <var>browsingContext</var> is a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#child-browsing-context" id="ref-for-child-browsing-context">child browsing context</a>, and the result of performing a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#cross-origin-resource-policy-check" id="ref-for-cross-origin-resource-policy-check">cross-origin resource policy check</a> with <var>browsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#bc-container-document" id="ref-for-bc-container-document">container document</a>'s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-origin" id="ref-for-concept-document-origin①">origin</a>, <var>browsingContext</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#bc-container-document" id="ref-for-bc-container-document①">container document</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object③">relevant settings object</a>, <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination②">destination</a>, <var>response</var> and true is <strong>blocked</strong>, then return "<code>Blocked</code>".</p>
        <div class="note" role="note">Here we’re running the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#cross-origin-resource-policy-check" id="ref-for-cross-origin-resource-policy-check①">cross-origin resource policy check</a> against the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#parent-browsing-context" id="ref-for-parent-browsing-context">parent browsing context</a> rather than sourceBrowsingContext. This is because we care about the same-originness of the embedded content against the parent context, not the navigation source.</div>
        <div class="issue" id="issue-cf0764a5"><a class="self-link" href="#issue-cf0764a5"></a>Is CORP enforcement needed on the prefetch path, too?</div>
       <li data-md>
        <p>Return "<code>Allowed</code>".</p>
      </ol>
     <li data-md>
      <p>Let (<var>response</var>, <var>locationURL</var>) be the result of <a data-link-type="dfn" href="#perform-a-common-navigational-fetch" id="ref-for-perform-a-common-navigational-fetch">performing a common navigational fetch</a> given <var>request</var>, <var>navigationType</var>, <var>browsingContext</var>, null (for forceEnvironment), <var>preRedirectHook</var>, <var>shouldBlockNavigationRequest</var> and <var>shouldBlockNavigationResponse</var>.</p>
     <li data-md>
      <p>If <var>locationURL</var> is a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑥">URL</a>:</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert④">Assert</a>: <var>locationURL</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme①">scheme</a> is not a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#fetch-scheme" id="ref-for-fetch-scheme">fetch scheme</a> and not "<code>javascript</code>".</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-url-scheme" id="ref-for-process-a-navigate-url-scheme">Process a navigate URL scheme</a> given <var>locationURL</var>, <var>browsingContext</var>, and <var>hasTransientActivation</var>, and return.</p>
      </ol>
     <li data-md>
      <p>Let <var>responsePolicyContainer</var> be the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#creating-a-policy-container-from-a-fetch-response" id="ref-for-creating-a-policy-container-from-a-fetch-response">creating a policy container from a fetch response</a> given <var>response</var> and <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-reserved-client" id="ref-for-concept-request-reserved-client⑤">reserved client</a>.</p>
     <li data-md>
      <p>Let <var>resultPolicyContainer</var> be the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#determining-navigation-params-policy-container" id="ref-for-determining-navigation-params-policy-container">determining navigation params policy container</a> given <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url" id="ref-for-concept-response-url">URL</a>, <var>historyPolicyContainer</var>, <var>initiatorPolicyContainer</var>, null, and <var>responsePolicyContainer</var>.</p>
     <li data-md>
      <p>Let <var>navigationParams</var> be a new <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-pparams" id="ref-for-navigation-pparams">navigation params</a> whose <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-id" id="ref-for-navigation-params-id">id</a> is <var>navigationId</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-request" id="ref-for-navigation-params-request">request</a> is <var>request</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-response" id="ref-for-navigation-params-response">response</a> is <var>response</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-origin" id="ref-for-navigation-params-origin">origin</a> is <var>responseOrigin</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-policy-container" id="ref-for-navigation-params-policy-container">policy container</a> is <var>resultPolicyContainer</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-sandboxing" id="ref-for-navigation-params-sandboxing">final sandboxing flag set</a> is <var>finalSandboxFlags</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-coop" id="ref-for-navigation-params-coop">cross-origin opener policy</a> is <var>responseCOOP</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-coop-enforcement-result" id="ref-for-navigation-params-coop-enforcement-result">COOP enforcement result</a> is <var>coopEnforcementResult</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-reserved-environment" id="ref-for-navigation-params-reserved-environment">reserved environment</a> is <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-reserved-client" id="ref-for-concept-request-reserved-client⑥">reserved client</a>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-browsing-context" id="ref-for-navigation-params-browsing-context">browsing context</a> is <var>browsingContext</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-hh" id="ref-for-navigation-params-hh">history handling</a> is <var>historyHandling</var>, and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-has-cross-origin-redirects" id="ref-for-navigation-params-has-cross-origin-redirects">has cross-origin redirects</a> is <var>hasCrossOriginRedirects</var>.</p>
     <li data-md>
      <p>Run <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-response" id="ref-for-process-a-navigate-response">process a navigate response</a> with <var>navigationType</var>, <var>allowedToDownload</var>, <var>hasTransientActivation</var>, and <var>navigationParams</var>.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="3" id="prefetch-algorithms"><span class="secno">3. </span><span class="content">Prefetch algorithms</span><a class="self-link" href="#prefetch-algorithms"></a></h2>
   <p>These algorithms are based on <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch" id="ref-for-process-a-navigate-fetch①">process a navigate fetch</a>.</p>
   <p class="issue" id="issue-eb60bbf4"><a class="self-link" href="#issue-eb60bbf4"></a>Check whether we need to expressly call Should request/response by blocked by Content Security Policy</p>
   <p class="issue" id="issue-1ea0021d"><a class="self-link" href="#issue-1ea0021d"></a>Check Service Worker integration</p>
   <div class="algorithm" data-algorithm="partitioned prefetch">
     To <dfn data-dfn-type="dfn" data-export id="partitioned-prefetch">partitioned prefetch<a class="self-link" href="#partitioned-prefetch"></a></dfn> given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document③">Document</a></code> <var>document</var>, <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑦">URL</a> <var>url</var> and <a data-link-type="dfn" href="https://w3c.github.io/webappsec-referrer-policy/#referrer-policy" id="ref-for-referrer-policy③">referrer policy</a> <var>referrerPolicy</var>, perform the following steps. 
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert⑤">Assert</a>: <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme②">scheme</a> is an <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-scheme" id="ref-for-http-scheme②">HTTP(S) scheme</a>.</p>
     <li data-md>
      <p>Let <var>partitionKey</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#determine-the-network-partition-key" id="ref-for-determine-the-network-partition-key">determining the network partition key</a> given <var>document</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object④">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>browsingContext</var> be <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document④">Document</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-document-bc" id="ref-for-concept-document-bc">browsing context</a>.</p>
     <li data-md>
      <p>Let <var>request</var> be a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑥">request</a> as follows:</p>
      <dl>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url②">URL</a>
       <dd data-md>
        <p><var>url</var></p>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy" id="ref-for-concept-request-referrer-policy">referrer policy</a>
       <dd data-md>
        <p><var>referrerPolicy</var></p>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator" id="ref-for-concept-request-initiator">initiator</a>
       <dd data-md>
        <p>"<code>prefetch</code>"</p>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination③">destination</a>
       <dd data-md>
        <p>"<code>document</code>"</p>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-credentials-mode" id="ref-for-concept-request-credentials-mode①">credentials mode</a>
       <dd data-md>
        <p>"<code>include</code>"</p>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-use-url-credentials-flag" id="ref-for-concept-request-use-url-credentials-flag①">use-URL-credentials flag</a>
       <dd data-md>
        <p>(set)</p>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client①">client</a>
       <dd data-md>
        <p><var>document</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object⑤">relevant settings object</a></p>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list" id="ref-for-concept-request-header-list">header list</a>
       <dd data-md>
        <ul>
         <li data-md>
          <p><code>`Sec-Purpose`</code>/<code>`prefetch`</code></p>
          <div class="note" role="note"> Implementations might also send vendor-specific headers, like Chromium’s <code>`Purpose`</code>/<code>`prefetch`</code>, Mozilla’s <code>`X-moz`</code>/<code>`prefetch`</code>, and WebKit’s <code>`X-Purpose`</code>/<code>`preview`</code>, for compatibility with existing server software. Over time we hope implementers and server software authors will adopt a standard header. </div>
        </ul>
      </dl>
     <li data-md>
      <p>Let <var>shouldBlockNavigationRequest</var> be the following steps, given <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑦">request</a> <var>request</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string③">string</a> <var>navigationType</var> and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment" id="ref-for-environment⑤">environment</a> <var>environment</var>:</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert⑥">Assert</a>: <var>navigationType</var> is "<code>other</code>".</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert⑦">Assert</a>: <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-reserved-client" id="ref-for-concept-request-reserved-client⑦">reserved client</a> is <var>environment</var>.</p>
       <li data-md>
        <p>Let <var>proposedPartitionKey</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#determine-the-network-partition-key" id="ref-for-determine-the-network-partition-key①">determining the network partition key</a> given <var>request</var>.</p>
       <li data-md>
        <p>If <var>partitionKey</var> is not equal to <var>proposedPartitionKey</var>, then return "<code>Blocked</code>".</p>
        <div class="issue" id="issue-a3686c91"><a class="self-link" href="#issue-a3686c91"></a>It might be possible to "downgrade" to <a data-link-type="dfn" href="#uncredentialed-prefetch" id="ref-for-uncredentialed-prefetch">uncredentialed prefetch</a> in this case.</div>
       <li data-md>
        <p>Otherwise, return "<code>Allowed</code>".</p>
      </ol>
     <li data-md>
      <p>Let (<var>response</var>, <var>locationURL</var>) be the result of <a data-link-type="dfn" href="#perform-a-common-navigational-fetch" id="ref-for-perform-a-common-navigational-fetch①">performing a common navigational fetch</a> given <var>request</var>, "<code>other</code>", <var>browsingContext</var>, null, an empty algorithm, <var>shouldBlockNavigationRequest</var>, and an empty algorithm.</p>
     <li data-md>
      <p>If <var>locationURL</var> is failure or a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑧">URL</a> whose <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme③">scheme</a> is not an <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-scheme" id="ref-for-http-scheme③">HTTP(S) scheme</a>, then set <var>response</var> to a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error⑤">network error</a>.</p>
     <li data-md>
      <p>TODO: navigate-to, frame-src, XFO enforcement should probably be left to navigation, but what about status codes and Content-Disposition?</p>
     <li data-md>
      <p>If <var>response</var> is a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error⑥">network error</a>, then return.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="#store-a-prefetch-record" id="ref-for-store-a-prefetch-record">Store a prefetch record</a> given <var>document</var>, <var>url</var>, <var>referrerPolicy</var> and <var>response</var>.</p>
    </ol>
   </div>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="list-of-sufficiently-strict-speculative-navigation-referrer-policies">list of sufficiently strict speculative navigation referrer policies</dfn> is a list containing the following: "", "<code>strict-origin-when-cross-origin</code>", "<code>strict-origin</code>", "<code>same-origin</code>", "<code>no-referrer</code>".</p>
   <div class="algorithm" data-algorithm="uncredentialed prefetch">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="uncredentialed-prefetch">uncredentialed prefetch</dfn> given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑤">Document</a></code> <var>document</var>, <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑨">URL</a> <var>url</var> and <a data-link-type="dfn" href="https://w3c.github.io/webappsec-referrer-policy/#referrer-policy" id="ref-for-referrer-policy④">referrer policy</a> <var>referrerPolicy</var>, perform the following steps. 
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert⑧">Assert</a>: <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme④">scheme</a> is an <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-scheme" id="ref-for-http-scheme④">HTTP(S) scheme</a>.</p>
     <li data-md>
      <p>If <var>referrerPolicy</var> is not in the <a data-link-type="dfn" href="#list-of-sufficiently-strict-speculative-navigation-referrer-policies" id="ref-for-list-of-sufficiently-strict-speculative-navigation-referrer-policies">list of sufficiently strict speculative navigation referrer policies</a>, then return.</p>
     <li data-md>
      <p>Let <var>browsingContext</var> be <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑥">Document</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-document-bc" id="ref-for-concept-document-bc①">browsing context</a>.</p>
     <li data-md>
      <p>Let <var>isolationOrigin</var> be a new <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque" id="ref-for-concept-origin-opaque">opaque origin</a>.</p>
      <div class="note" role="note">This is used to ensure a distinct network partition key is used.</div>
     <li data-md>
      <p>Let <var>isolatedEnvironment</var> be a new <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment" id="ref-for-environment⑥">environment</a> whose <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-id" id="ref-for-concept-environment-id②">id</a> is a unique opaque string, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context" id="ref-for-concept-environment-target-browsing-context①">target browsing context</a> is <var>browsingContext</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url" id="ref-for-concept-environment-creation-url②">creation URL</a> is <code>about:blank</code>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-creation-url" id="ref-for-concept-environment-top-level-creation-url②">top-level creation URL</a> is <code>about:blank</code>, and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin" id="ref-for-concept-environment-top-level-origin②">top-level origin</a> is <var>isolationOrigin</var>.</p>
     <li data-md>
      <p>Let <var>originalPartitionKey</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#determine-the-network-partition-key" id="ref-for-determine-the-network-partition-key②">determining the network partition key</a> given <var>document</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object⑥">relevant settings object</a>.</p>
     <li data-md>
      <p>Let <var>request</var> be a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑧">request</a> as follows:</p>
      <dl>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url③">URL</a>
       <dd data-md>
        <p><var>url</var></p>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy" id="ref-for-concept-request-referrer-policy①">referrer policy</a>
       <dd data-md>
        <p><var>referrerPolicy</var></p>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator" id="ref-for-concept-request-initiator①">initiator</a>
       <dd data-md>
        <p>"<code>prefetch</code>"</p>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination④">destination</a>
       <dd data-md>
        <p>"<code>document</code>"</p>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-credentials-mode" id="ref-for-concept-request-credentials-mode②">credentials mode</a>
       <dd data-md>
        <p>"<code>include</code>"</p>
        <div class="note" role="note">Though credentials are included, they will be isolated such that no credentials are present to begin with.</div>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-cache-mode" id="ref-for-concept-request-cache-mode">cache mode</a>
       <dd data-md>
        <p>"<code>no-store</code>"</p>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client②">client</a>
       <dd data-md>
        <p><var>document</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object⑦">relevant settings object</a></p>
       <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list" id="ref-for-concept-request-header-list①">header list</a>
       <dd data-md>
        <ul>
         <li data-md>
          <p><code>`Sec-Purpose`</code>/<code>`prefetch`</code></p>
          <div class="note" role="note"> Implementations might also send vendor-specific headers, like Chromium’s <code>`Purpose`</code>/<code>`prefetch`</code>, Mozilla’s <code>`X-moz`</code>/<code>`prefetch`</code>, and WebKit’s <code>`X-Purpose`</code>/<code>`preview`</code>, for compatibility with existing server software. Over time we hope implementers and server software authors will adopt a standard header. </div>
        </ul>
      </dl>
     <li data-md>
      <p>Let <var>originsWithConflictingCredentials</var> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">ordered set</a>.</p>
     <li data-md>
      <p>Let <var>shouldBlockNavigationRequest</var> be the following steps, given <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑨">request</a> <var>request</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string④">string</a> <var>navigationType</var> and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment" id="ref-for-environment⑦">environment</a> <var>environment</var>:</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert⑨">Assert</a>: <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-reserved-client" id="ref-for-concept-request-reserved-client⑧">reserved client</a> is <var>isolatedEnvironment</var> and not <var>environment</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①⓪">Assert</a>: <var>navigationType</var> is "<code>other</code>".</p>
       <li data-md>
        <p>Let <var>hypotheticalPartitionKey</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#determine-the-network-partition-key" id="ref-for-determine-the-network-partition-key③">determining the network partition key</a> given <var>environment</var>.</p>
       <li data-md>
        <p>If <var>originalPartitionKey</var> is equal to <var>hypotheticalPartitionKey</var>, then return "<code>Blocked</code>".</p>
        <div class="note" role="note">The prefetch would end up in the same partition as the prefetch came from in this case. <var>environment</var> represents the environment that would ordinarily be used during navigation fetch.</div>
       <li data-md>
        <p>If there are <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#credentials" id="ref-for-credentials">credentials</a> associated with <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url①">current URL</a> and <var>hypotheticalPartitionKey</var>, then <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append">append</a> <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url②">current URL</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin④">origin</a> to <var>originsWithConflictingCredentials</var>.</p>
       <li data-md>
        <p>Return "<code>Allowed</code>".</p>
      </ol>
     <li data-md>
      <p>Let (<var>response</var>, <var>locationURL</var>) be the result of <a data-link-type="dfn" href="#perform-a-common-navigational-fetch" id="ref-for-perform-a-common-navigational-fetch②">performing a common navigational fetch</a> given <var>request</var>, "<code>other</code>", <var>browsingContext</var>, <var>isolatedEnvironment</var>, an empty algorithm, <var>shouldBlockNavigationRequest</var>, and an empty algorithm.</p>
     <li data-md>
      <p>If <var>locationURL</var> is failure or a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①⓪">URL</a> whose <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme⑤">scheme</a> is not an <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-scheme" id="ref-for-http-scheme⑤">HTTP(S) scheme</a>, then set <var>response</var> to a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error⑦">network error</a>.</p>
     <li data-md>
      <p>TODO: navigate-to, frame-src, XFO enforcement should probably be left to navigation, but what about status codes and Content-Disposition?</p>
     <li data-md>
      <p>If <var>response</var> is a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error⑧">network error</a>, then return.</p>
     <li data-md>
      <p>If <var>originsWithConflictingCredentials</var> is not empty, then return.</p>
      <div class="note" role="note">This means that if any origin along the redirect chain had credentials, the prefetch is discarded. This reduces the chance of the user observing a logged-out page when they are logged in.</div>
     <li data-md>
      <p><a data-link-type="dfn" href="#store-a-prefetch-record" id="ref-for-store-a-prefetch-record①">Store a prefetch record</a> given <var>document</var>, <var>url</var>, <var>referrerPolicy</var> and <var>response</var>.</p>
    </ol>
    <div class="issue" id="issue-239df98e"><a class="self-link" href="#issue-239df98e"></a>This ends up setting the <code>`Cache-Control`</code> and <code>`Pragma`</code> request headers, which is contrary to what Chromium does today when skipping cache here. One approach would be to add a flag similar to <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#no-cache-prevent-cache-control" id="ref-for-no-cache-prevent-cache-control">prevent no-cache cache-control header modification flag</a>. It would also be possible to have a cache that can be copied into the ordinary cache, like Chromium does for cookies.</div>
    <div class="issue" id="issue-d45eff4c"><a class="self-link" href="#issue-d45eff4c"></a>This does not fully address cookie isolation or migration (somewhat complicated by <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> not dealing with it), and similar measures with authorization entries, TLS client certificates, and connection pools. This is currently complicated by the fact that even those that are covered by the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#network-partition-key" id="ref-for-network-partition-key①">network partition key</a> are difficult to address while it’s not possible to further partition.</div>
    <div class="issue" id="issue-414cc665"><a class="self-link" href="#issue-414cc665"></a>Update this to include the <code>`Supports-Loading-Mode`</code> mechanism to allow responses to continue despite cookies.</div>
    <div class="issue" id="issue-cdd1a31a"><a class="self-link" href="#issue-cdd1a31a"></a>Further review is needed of the cookies-present handling and its interaction with redirects and caches.</div>
   </div>
  </main>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#prefetch-record-expiry-time">expiry time</a><span>, in § 1</span>
   <li><a href="#find-a-matching-prefetch-response">find a matching prefetch response</a><span>, in § 1</span>
   <li><a href="#list-of-sufficiently-strict-speculative-navigation-referrer-policies">list of sufficiently strict speculative navigation referrer policies</a><span>, in § 3</span>
   <li><a href="#partitioned-prefetch">partitioned prefetch</a><span>, in § 3</span>
   <li><a href="#perform-a-common-navigational-fetch">perform a common navigational fetch</a><span>, in § 2</span>
   <li><a href="#prefetch-buffer">prefetch buffer</a><span>, in § 1</span>
   <li><a href="#prefetch-record">prefetch record</a><span>, in § 1</span>
   <li><a href="#prefetch-record-referrer-policy">referrer policy</a><span>, in § 1</span>
   <li><a href="#prefetch-record-response">response</a><span>, in § 1</span>
   <li><a href="#store-a-prefetch-record">store a prefetch record</a><span>, in § 1</span>
   <li><a href="#uncredentialed-prefetch">uncredentialed prefetch</a><span>, in § 3</span>
   <li><a href="#prefetch-record-url">URL</a><span>, in § 1</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-should-block-navigation-request">
   <a href="https://w3c.github.io/webappsec-csp/#should-block-navigation-request">https://w3c.github.io/webappsec-csp/#should-block-navigation-request</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-should-block-navigation-request">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-document">
   <a href="https://dom.spec.whatwg.org/#document">https://dom.spec.whatwg.org/#document</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document">1. Concepts</a> <a href="#ref-for-document①">(2)</a> <a href="#ref-for-document②">(3)</a>
    <li><a href="#ref-for-document③">3. Prefetch algorithms</a> <a href="#ref-for-document④">(2)</a> <a href="#ref-for-document⑤">(3)</a> <a href="#ref-for-document⑥">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-element-local-name">
   <a href="https://dom.spec.whatwg.org/#concept-element-local-name">https://dom.spec.whatwg.org/#concept-element-local-name</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-element-local-name">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-document-origin">
   <a href="https://dom.spec.whatwg.org/#concept-document-origin">https://dom.spec.whatwg.org/#concept-document-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-document-origin">2. HTML Patches</a> <a href="#ref-for-concept-document-origin①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-document-url">
   <a href="https://dom.spec.whatwg.org/#concept-document-url">https://dom.spec.whatwg.org/#concept-document-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-document-url">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-cache-mode">
   <a href="https://fetch.spec.whatwg.org/#concept-request-cache-mode">https://fetch.spec.whatwg.org/#concept-request-cache-mode</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-cache-mode">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-client">
   <a href="https://fetch.spec.whatwg.org/#concept-request-client">https://fetch.spec.whatwg.org/#concept-request-client</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-client">2. HTML Patches</a>
    <li><a href="#ref-for-concept-request-client①">3. Prefetch algorithms</a> <a href="#ref-for-concept-request-client②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-credentials">
   <a href="https://fetch.spec.whatwg.org/#credentials">https://fetch.spec.whatwg.org/#credentials</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-credentials">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-credentials-mode">
   <a href="https://fetch.spec.whatwg.org/#concept-request-credentials-mode">https://fetch.spec.whatwg.org/#concept-request-credentials-mode</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-credentials-mode">2. HTML Patches</a>
    <li><a href="#ref-for-concept-request-credentials-mode①">3. Prefetch algorithms</a> <a href="#ref-for-concept-request-credentials-mode②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-cross-origin-resource-policy-check">
   <a href="https://fetch.spec.whatwg.org/#cross-origin-resource-policy-check">https://fetch.spec.whatwg.org/#cross-origin-resource-policy-check</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-cross-origin-resource-policy-check">2. HTML Patches</a> <a href="#ref-for-cross-origin-resource-policy-check①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-current-url">
   <a href="https://fetch.spec.whatwg.org/#concept-request-current-url">https://fetch.spec.whatwg.org/#concept-request-current-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-current-url">2. HTML Patches</a>
    <li><a href="#ref-for-concept-request-current-url①">3. Prefetch algorithms</a> <a href="#ref-for-concept-request-current-url②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-destination">
   <a href="https://fetch.spec.whatwg.org/#concept-request-destination">https://fetch.spec.whatwg.org/#concept-request-destination</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-destination">2. HTML Patches</a> <a href="#ref-for-concept-request-destination①">(2)</a> <a href="#ref-for-concept-request-destination②">(3)</a>
    <li><a href="#ref-for-concept-request-destination③">3. Prefetch algorithms</a> <a href="#ref-for-concept-request-destination④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-determine-the-network-partition-key">
   <a href="https://fetch.spec.whatwg.org/#determine-the-network-partition-key">https://fetch.spec.whatwg.org/#determine-the-network-partition-key</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-determine-the-network-partition-key">3. Prefetch algorithms</a> <a href="#ref-for-determine-the-network-partition-key①">(2)</a> <a href="#ref-for-determine-the-network-partition-key②">(3)</a> <a href="#ref-for-determine-the-network-partition-key③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-fetch">
   <a href="https://fetch.spec.whatwg.org/#concept-fetch">https://fetch.spec.whatwg.org/#concept-fetch</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-fetch">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-fetch-scheme">
   <a href="https://fetch.spec.whatwg.org/#fetch-scheme">https://fetch.spec.whatwg.org/#fetch-scheme</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-fetch-scheme">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-header-list">
   <a href="https://fetch.spec.whatwg.org/#concept-request-header-list">https://fetch.spec.whatwg.org/#concept-request-header-list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-header-list">3. Prefetch algorithms</a> <a href="#ref-for-concept-request-header-list①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-http-scheme">
   <a href="https://fetch.spec.whatwg.org/#http-scheme">https://fetch.spec.whatwg.org/#http-scheme</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-http-scheme">2. HTML Patches</a> <a href="#ref-for-http-scheme①">(2)</a>
    <li><a href="#ref-for-http-scheme②">3. Prefetch algorithms</a> <a href="#ref-for-http-scheme③">(2)</a> <a href="#ref-for-http-scheme④">(3)</a> <a href="#ref-for-http-scheme⑤">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-http-redirect-fetch">
   <a href="https://fetch.spec.whatwg.org/#concept-http-redirect-fetch">https://fetch.spec.whatwg.org/#concept-http-redirect-fetch</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-http-redirect-fetch">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-initiator">
   <a href="https://fetch.spec.whatwg.org/#concept-request-initiator">https://fetch.spec.whatwg.org/#concept-request-initiator</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-initiator">3. Prefetch algorithms</a> <a href="#ref-for-concept-request-initiator①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-response-location-url">
   <a href="https://fetch.spec.whatwg.org/#concept-response-location-url">https://fetch.spec.whatwg.org/#concept-response-location-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-response-location-url">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-mode">
   <a href="https://fetch.spec.whatwg.org/#concept-request-mode">https://fetch.spec.whatwg.org/#concept-request-mode</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-mode">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-network-error">
   <a href="https://fetch.spec.whatwg.org/#concept-network-error">https://fetch.spec.whatwg.org/#concept-network-error</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-network-error">2. HTML Patches</a> <a href="#ref-for-concept-network-error①">(2)</a> <a href="#ref-for-concept-network-error②">(3)</a> <a href="#ref-for-concept-network-error③">(4)</a> <a href="#ref-for-concept-network-error④">(5)</a>
    <li><a href="#ref-for-concept-network-error⑤">3. Prefetch algorithms</a> <a href="#ref-for-concept-network-error⑥">(2)</a> <a href="#ref-for-concept-network-error⑦">(3)</a> <a href="#ref-for-concept-network-error⑧">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-network-partition-key">
   <a href="https://fetch.spec.whatwg.org/#network-partition-key">https://fetch.spec.whatwg.org/#network-partition-key</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-network-partition-key">2. HTML Patches</a>
    <li><a href="#ref-for-network-partition-key①">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-origin">
   <a href="https://fetch.spec.whatwg.org/#concept-request-origin">https://fetch.spec.whatwg.org/#concept-request-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-origin">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-no-cache-prevent-cache-control">
   <a href="https://fetch.spec.whatwg.org/#no-cache-prevent-cache-control">https://fetch.spec.whatwg.org/#no-cache-prevent-cache-control</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-no-cache-prevent-cache-control">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-process-response">
   <a href="https://fetch.spec.whatwg.org/#process-response">https://fetch.spec.whatwg.org/#process-response</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-process-response">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-redirect-mode">
   <a href="https://fetch.spec.whatwg.org/#concept-request-redirect-mode">https://fetch.spec.whatwg.org/#concept-request-redirect-mode</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-redirect-mode">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-referrer-policy">
   <a href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy">https://fetch.spec.whatwg.org/#concept-request-referrer-policy</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-referrer-policy">3. Prefetch algorithms</a> <a href="#ref-for-concept-request-referrer-policy①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-replaces-client-id">
   <a href="https://fetch.spec.whatwg.org/#concept-request-replaces-client-id">https://fetch.spec.whatwg.org/#concept-request-replaces-client-id</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-replaces-client-id">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request">
   <a href="https://fetch.spec.whatwg.org/#concept-request">https://fetch.spec.whatwg.org/#concept-request</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request">2. HTML Patches</a> <a href="#ref-for-concept-request①">(2)</a> <a href="#ref-for-concept-request②">(3)</a> <a href="#ref-for-concept-request③">(4)</a> <a href="#ref-for-concept-request④">(5)</a> <a href="#ref-for-concept-request⑤">(6)</a>
    <li><a href="#ref-for-concept-request⑥">3. Prefetch algorithms</a> <a href="#ref-for-concept-request⑦">(2)</a> <a href="#ref-for-concept-request⑧">(3)</a> <a href="#ref-for-concept-request⑨">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-reserved-client">
   <a href="https://fetch.spec.whatwg.org/#concept-request-reserved-client">https://fetch.spec.whatwg.org/#concept-request-reserved-client</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-reserved-client">2. HTML Patches</a> <a href="#ref-for-concept-request-reserved-client①">(2)</a> <a href="#ref-for-concept-request-reserved-client②">(3)</a> <a href="#ref-for-concept-request-reserved-client③">(4)</a> <a href="#ref-for-concept-request-reserved-client④">(5)</a> <a href="#ref-for-concept-request-reserved-client⑤">(6)</a> <a href="#ref-for-concept-request-reserved-client⑥">(7)</a>
    <li><a href="#ref-for-concept-request-reserved-client⑦">3. Prefetch algorithms</a> <a href="#ref-for-concept-request-reserved-client⑧">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-response">
   <a href="https://fetch.spec.whatwg.org/#concept-response">https://fetch.spec.whatwg.org/#concept-response</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-response">1. Concepts</a> <a href="#ref-for-concept-response①">(2)</a>
    <li><a href="#ref-for-concept-response②">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-response-url">
   <a href="https://fetch.spec.whatwg.org/#concept-response-url">https://fetch.spec.whatwg.org/#concept-response-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-response-url">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-use-url-credentials-flag">
   <a href="https://fetch.spec.whatwg.org/#concept-request-use-url-credentials-flag">https://fetch.spec.whatwg.org/#concept-request-use-url-credentials-flag</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-use-url-credentials-flag">2. HTML Patches</a>
    <li><a href="#ref-for-concept-request-use-url-credentials-flag①">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-request-user-activation">
   <a href="https://fetch.spec.whatwg.org/#request-user-activation">https://fetch.spec.whatwg.org/#request-user-activation</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-request-user-activation">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-domhighrestimestamp">
   <a href="https://www.w3.org/TR/hr-time-2/#dom-domhighrestimestamp">https://www.w3.org/TR/hr-time-2/#dom-domhighrestimestamp</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-domhighrestimestamp">1. Concepts</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-current-high-resolution-time">
   <a href="https://www.w3.org/TR/hr-time-2/#dfn-current-high-resolution-time">https://www.w3.org/TR/hr-time-2/#dfn-current-high-resolution-time</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-current-high-resolution-time">1. Concepts</a> <a href="#ref-for-dfn-current-high-resolution-time①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-active-document">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#active-document">https://html.spec.whatwg.org/multipage/browsers.html#active-document</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-active-document">2. HTML Patches</a> <a href="#ref-for-active-document①">(2)</a> <a href="#ref-for-active-document②">(3)</a> <a href="#ref-for-active-document③">(4)</a> <a href="#ref-for-active-document④">(5)</a> <a href="#ref-for-active-document⑤">(6)</a> <a href="#ref-for-active-document⑥">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-active-service-worker">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-active-service-worker</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-environment-active-service-worker">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-params-browsing-context">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-browsing-context">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-browsing-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params-browsing-context">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-browsing-context-scope-origin">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-scope-origin">https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-scope-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-context-scope-origin">2. HTML Patches</a> <a href="#ref-for-browsing-context-scope-origin①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-child-browsing-context">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#child-browsing-context">https://html.spec.whatwg.org/multipage/browsers.html#child-browsing-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-child-browsing-context">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-bc-container">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#bc-container">https://html.spec.whatwg.org/multipage/browsers.html#bc-container</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-bc-container">2. HTML Patches</a> <a href="#ref-for-bc-container①">(2)</a> <a href="#ref-for-bc-container②">(3)</a> <a href="#ref-for-bc-container③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-bc-container-document">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#bc-container-document">https://html.spec.whatwg.org/multipage/browsers.html#bc-container-document</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-bc-container-document">2. HTML Patches</a> <a href="#ref-for-bc-container-document①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-params-coop-enforcement-result">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-coop-enforcement-result">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-coop-enforcement-result</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params-coop-enforcement-result">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-creating-a-policy-container-from-a-fetch-response">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#creating-a-policy-container-from-a-fetch-response">https://html.spec.whatwg.org/multipage/origin.html#creating-a-policy-container-from-a-fetch-response</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-creating-a-policy-container-from-a-fetch-response">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-creation-url">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-environment-creation-url">2. HTML Patches</a> <a href="#ref-for-concept-environment-creation-url①">(2)</a>
    <li><a href="#ref-for-concept-environment-creation-url②">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-params-coop">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-coop">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-coop</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params-coop">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-coop-enforcement-result">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-result">https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-result</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-coop-enforcement-result">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-coop-enforcement-source">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-source">https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-source</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-coop-enforcement-source">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-coop-enforcement-origin">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-origin">https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-coop-enforcement-origin">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-determining-navigation-params-policy-container">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#determining-navigation-params-policy-container">https://html.spec.whatwg.org/multipage/origin.html#determining-navigation-params-policy-container</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-determining-navigation-params-policy-container">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-determining-the-origin">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#determining-the-origin">https://html.spec.whatwg.org/multipage/browsers.html#determining-the-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-determining-the-origin">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-coop-enforce">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforce">https://html.spec.whatwg.org/multipage/origin.html#coop-enforce</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-coop-enforce">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-environment">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#environment">https://html.spec.whatwg.org/multipage/webappapis.html#environment</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-environment">2. HTML Patches</a> <a href="#ref-for-environment①">(2)</a> <a href="#ref-for-environment②">(3)</a> <a href="#ref-for-environment③">(4)</a> <a href="#ref-for-environment④">(5)</a>
    <li><a href="#ref-for-environment⑤">3. Prefetch algorithms</a> <a href="#ref-for-environment⑥">(2)</a> <a href="#ref-for-environment⑦">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-environment-discarding-steps">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-discarding-steps">https://html.spec.whatwg.org/multipage/webappapis.html#environment-discarding-steps</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-environment-discarding-steps">2. HTML Patches</a> <a href="#ref-for-environment-discarding-steps①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-params-sandboxing">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-sandboxing">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-sandboxing</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params-sandboxing">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-forced-sandboxing-flag-set">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#forced-sandboxing-flag-set">https://html.spec.whatwg.org/multipage/origin.html#forced-sandboxing-flag-set</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-forced-sandboxing-flag-set">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-fully-active">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#fully-active">https://html.spec.whatwg.org/multipage/browsers.html#fully-active</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-fully-active">1. Concepts</a> <a href="#ref-for-fully-active①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-params-has-cross-origin-redirects">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-has-cross-origin-redirects">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-has-cross-origin-redirects</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params-has-cross-origin-redirects">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-params-hh">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-hh">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-hh</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params-hh">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-history-handling-behavior">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#history-handling-behavior">https://html.spec.whatwg.org/multipage/browsing-the-web.html#history-handling-behavior</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-history-handling-behavior">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-params-id">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-id">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-id</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params-id">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-id">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-id">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-id</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-id">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-pparams">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-pparams">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-pparams</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-pparams">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-coop-enforcement-bcg-switch">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-bcg-switch">https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-bcg-switch</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-coop-enforcement-bcg-switch">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-networking-task-source">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#networking-task-source">https://html.spec.whatwg.org/multipage/webappapis.html#networking-task-source</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-networking-task-source">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-obtain-coop">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#obtain-coop">https://html.spec.whatwg.org/multipage/origin.html#obtain-coop</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-coop">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-origin-opaque">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque">https://html.spec.whatwg.org/multipage/origin.html#concept-origin-opaque</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-origin-opaque">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-params-origin">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-origin">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params-origin">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-parent-browsing-context">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#parent-browsing-context">https://html.spec.whatwg.org/multipage/browsers.html#parent-browsing-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parent-browsing-context">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-params-policy-container">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-policy-container">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-policy-container</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params-policy-container">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-process-a-navigate-fetch">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch">https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-process-a-navigate-fetch">2. HTML Patches</a>
    <li><a href="#ref-for-process-a-navigate-fetch①">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-process-a-navigate-response">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-response">https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-response</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-process-a-navigate-response">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-process-a-navigate-url-scheme">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-url-scheme">https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-url-scheme</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-process-a-navigate-url-scheme">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-relevant-global">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-relevant-global">1. Concepts</a> <a href="#ref-for-concept-relevant-global①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-relevant-settings-object">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-relevant-settings-object">2. HTML Patches</a> <a href="#ref-for-relevant-settings-object①">(2)</a> <a href="#ref-for-relevant-settings-object②">(3)</a> <a href="#ref-for-relevant-settings-object③">(4)</a>
    <li><a href="#ref-for-relevant-settings-object④">3. Prefetch algorithms</a> <a href="#ref-for-relevant-settings-object⑤">(2)</a> <a href="#ref-for-relevant-settings-object⑥">(3)</a> <a href="#ref-for-relevant-settings-object⑦">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-params-request">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-request">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-request</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params-request">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-params-reserved-environment">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-reserved-environment">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-reserved-environment</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params-reserved-environment">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigation-params-response">
   <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-response">https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-response</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-params-response">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-same-origin">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#same-origin">https://html.spec.whatwg.org/multipage/origin.html#same-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-same-origin">2. HTML Patches</a> <a href="#ref-for-same-origin①">(2)</a> <a href="#ref-for-same-origin②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sandboxing-flag-set">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#sandboxing-flag-set">https://html.spec.whatwg.org/multipage/origin.html#sandboxing-flag-set</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sandboxing-flag-set">2. HTML Patches</a> <a href="#ref-for-sandboxing-flag-set①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-bc-sandboxing-flags">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#concept-bc-sandboxing-flags">https://html.spec.whatwg.org/multipage/origin.html#concept-bc-sandboxing-flags</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-bc-sandboxing-flags">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-target-browsing-context">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-target-browsing-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-environment-target-browsing-context">2. HTML Patches</a>
    <li><a href="#ref-for-concept-environment-target-browsing-context①">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-task">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task">https://html.spec.whatwg.org/multipage/webappapis.html#concept-task</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-task">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-top-level-browsing-context">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-top-level-browsing-context">2. HTML Patches</a> <a href="#ref-for-top-level-browsing-context①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-top-level-creation-url">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-creation-url">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-creation-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-environment-top-level-creation-url">2. HTML Patches</a> <a href="#ref-for-concept-environment-top-level-creation-url①">(2)</a>
    <li><a href="#ref-for-concept-environment-top-level-creation-url②">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-environment-top-level-origin">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin">https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-top-level-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-environment-top-level-origin">2. HTML Patches</a> <a href="#ref-for-concept-environment-top-level-origin①">(2)</a>
    <li><a href="#ref-for-concept-environment-top-level-origin②">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-coop-enforcement-url">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-url">https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-coop-enforcement-url">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-coop-struct-value">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#coop-struct-value">https://html.spec.whatwg.org/multipage/origin.html#coop-struct-value</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-coop-struct-value">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-coop-enforcement-bcg-switch-report-only">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-bcg-switch-report-only">https://html.spec.whatwg.org/multipage/origin.html#coop-enforcement-bcg-switch-report-only</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-coop-enforcement-bcg-switch-report-only">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-set-append">
   <a href="https://infra.spec.whatwg.org/#set-append">https://infra.spec.whatwg.org/#set-append</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-append">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-assert">
   <a href="https://infra.spec.whatwg.org/#assert">https://infra.spec.whatwg.org/#assert</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-assert">1. Concepts</a> <a href="#ref-for-assert①">(2)</a>
    <li><a href="#ref-for-assert②">2. HTML Patches</a> <a href="#ref-for-assert③">(2)</a> <a href="#ref-for-assert④">(3)</a>
    <li><a href="#ref-for-assert⑤">3. Prefetch algorithms</a> <a href="#ref-for-assert⑥">(2)</a> <a href="#ref-for-assert⑦">(3)</a> <a href="#ref-for-assert⑧">(4)</a> <a href="#ref-for-assert⑨">(5)</a> <a href="#ref-for-assert①⓪">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-iteration-break">
   <a href="https://infra.spec.whatwg.org/#iteration-break">https://infra.spec.whatwg.org/#iteration-break</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iteration-break">2. HTML Patches</a> <a href="#ref-for-iteration-break①">(2)</a> <a href="#ref-for-iteration-break②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-iteration-continue">
   <a href="https://infra.spec.whatwg.org/#iteration-continue">https://infra.spec.whatwg.org/#iteration-continue</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iteration-continue">1. Concepts</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-iterate">
   <a href="https://infra.spec.whatwg.org/#list-iterate">https://infra.spec.whatwg.org/#list-iterate</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-iterate">1. Concepts</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-struct-item">
   <a href="https://infra.spec.whatwg.org/#struct-item">https://infra.spec.whatwg.org/#struct-item</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-struct-item">1. Concepts</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list">
   <a href="https://infra.spec.whatwg.org/#list">https://infra.spec.whatwg.org/#list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list">1. Concepts</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ordered-set">
   <a href="https://infra.spec.whatwg.org/#ordered-set">https://infra.spec.whatwg.org/#ordered-set</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ordered-set">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-remove">
   <a href="https://infra.spec.whatwg.org/#list-remove">https://infra.spec.whatwg.org/#list-remove</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-remove">1. Concepts</a> <a href="#ref-for-list-remove①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-string">
   <a href="https://infra.spec.whatwg.org/#string">https://infra.spec.whatwg.org/#string</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string">2. HTML Patches</a> <a href="#ref-for-string①">(2)</a> <a href="#ref-for-string②">(3)</a>
    <li><a href="#ref-for-string③">3. Prefetch algorithms</a> <a href="#ref-for-string④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-struct">
   <a href="https://infra.spec.whatwg.org/#struct">https://infra.spec.whatwg.org/#struct</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-struct">1. Concepts</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-set-union">
   <a href="https://infra.spec.whatwg.org/#set-union">https://infra.spec.whatwg.org/#set-union</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-union">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-referrer-policy">
   <a href="https://w3c.github.io/webappsec-referrer-policy/#referrer-policy">https://w3c.github.io/webappsec-referrer-policy/#referrer-policy</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-referrer-policy">1. Concepts</a> <a href="#ref-for-referrer-policy①">(2)</a> <a href="#ref-for-referrer-policy②">(3)</a>
    <li><a href="#ref-for-referrer-policy③">3. Prefetch algorithms</a> <a href="#ref-for-referrer-policy④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-fragment">
   <a href="https://url.spec.whatwg.org/#concept-url-fragment">https://url.spec.whatwg.org/#concept-url-fragment</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-fragment">2. HTML Patches</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-origin">
   <a href="https://url.spec.whatwg.org/#concept-url-origin">https://url.spec.whatwg.org/#concept-url-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-origin">2. HTML Patches</a> <a href="#ref-for-concept-url-origin①">(2)</a> <a href="#ref-for-concept-url-origin②">(3)</a> <a href="#ref-for-concept-url-origin③">(4)</a>
    <li><a href="#ref-for-concept-url-origin④">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url-scheme">
   <a href="https://url.spec.whatwg.org/#concept-url-scheme">https://url.spec.whatwg.org/#concept-url-scheme</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-scheme">2. HTML Patches</a> <a href="#ref-for-concept-url-scheme①">(2)</a>
    <li><a href="#ref-for-concept-url-scheme②">3. Prefetch algorithms</a> <a href="#ref-for-concept-url-scheme③">(2)</a> <a href="#ref-for-concept-url-scheme④">(3)</a> <a href="#ref-for-concept-url-scheme⑤">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url">
   <a href="https://url.spec.whatwg.org/#concept-url">https://url.spec.whatwg.org/#concept-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url">1. Concepts</a> <a href="#ref-for-concept-url①">(2)</a> <a href="#ref-for-concept-url②">(3)</a>
    <li><a href="#ref-for-concept-url③">2. HTML Patches</a> <a href="#ref-for-concept-url④">(2)</a> <a href="#ref-for-concept-url⑤">(3)</a> <a href="#ref-for-concept-url⑥">(4)</a>
    <li><a href="#ref-for-concept-url⑦">3. Prefetch algorithms</a> <a href="#ref-for-concept-url⑧">(2)</a> <a href="#ref-for-concept-url⑨">(3)</a> <a href="#ref-for-concept-url①⓪">(4)</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[CSP3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-should-block-navigation-request">should navigation request of type be blocked by content security policy?</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-document">Document</span>
     <li><span class="dfn-paneled" id="term-for-concept-element-local-name">local name</span>
     <li><span class="dfn-paneled" id="term-for-concept-document-origin">origin</span>
     <li><span class="dfn-paneled" id="term-for-concept-document-url">url</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-concept-request-cache-mode">cache mode</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-client">client</span>
     <li><span class="dfn-paneled" id="term-for-credentials">credentials</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-credentials-mode">credentials mode</span>
     <li><span class="dfn-paneled" id="term-for-cross-origin-resource-policy-check">cross-origin resource policy check</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-current-url">current url</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-destination">destination</span>
     <li><span class="dfn-paneled" id="term-for-determine-the-network-partition-key">determining the network partition key</span>
     <li><span class="dfn-paneled" id="term-for-concept-fetch">fetch</span>
     <li><span class="dfn-paneled" id="term-for-fetch-scheme">fetch scheme</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-header-list">header list</span>
     <li><span class="dfn-paneled" id="term-for-http-scheme">http(s) scheme</span>
     <li><span class="dfn-paneled" id="term-for-concept-http-redirect-fetch">http-redirect fetch</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-initiator">initiator</span>
     <li><span class="dfn-paneled" id="term-for-concept-response-location-url">location url</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-mode">mode</span>
     <li><span class="dfn-paneled" id="term-for-concept-network-error">network error</span>
     <li><span class="dfn-paneled" id="term-for-network-partition-key">network partition key</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-origin">origin</span>
     <li><span class="dfn-paneled" id="term-for-no-cache-prevent-cache-control">prevent no-cache cache-control header modification flag</span>
     <li><span class="dfn-paneled" id="term-for-process-response">process response</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-redirect-mode">redirect mode</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-referrer-policy">referrer policy</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-replaces-client-id">replaces client id</span>
     <li><span class="dfn-paneled" id="term-for-concept-request">request</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-reserved-client">reserved client</span>
     <li><span class="dfn-paneled" id="term-for-concept-response">response</span>
     <li><span class="dfn-paneled" id="term-for-concept-response-url">url <small>(for response)</small></span>
     <li><span class="dfn-paneled" id="term-for-concept-request-use-url-credentials-flag">use-url-credentials flag</span>
     <li><span class="dfn-paneled" id="term-for-request-user-activation">user-activation</span>
    </ul>
   <li>
    <a data-link-type="biblio">[hr-time-2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-dom-domhighrestimestamp">DOMHighResTimeStamp</span>
     <li><span class="dfn-paneled" id="term-for-dfn-current-high-resolution-time">current high resolution time</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-active-document">active document</span>
     <li><span class="dfn-paneled" id="term-for-concept-environment-active-service-worker">active service worker</span>
     <li><span class="dfn-paneled" id="term-for-navigation-params-browsing-context">browsing context <small>(for navigation params)</small></span>
     <li><span class="dfn-paneled" id="term-for-browsing-context-scope-origin">browsing context scope origin</span>
     <li><span class="dfn-paneled" id="term-for-child-browsing-context">child browsing context</span>
     <li><span class="dfn-paneled" id="term-for-bc-container">container</span>
     <li><span class="dfn-paneled" id="term-for-bc-container-document">container document</span>
     <li><span class="dfn-paneled" id="term-for-navigation-params-coop-enforcement-result">coop enforcement result</span>
     <li><span class="dfn-paneled" id="term-for-creating-a-policy-container-from-a-fetch-response">creating a policy container from a fetch response</span>
     <li><span class="dfn-paneled" id="term-for-concept-environment-creation-url">creation url</span>
     <li><span class="dfn-paneled" id="term-for-navigation-params-coop">cross-origin opener policy <small>(for navigation params)</small></span>
     <li><span class="dfn-paneled" id="term-for-coop-enforcement-result">cross-origin opener policy enforcement result</span>
     <li><span class="dfn-paneled" id="term-for-coop-enforcement-source">current context is navigation source</span>
     <li><span class="dfn-paneled" id="term-for-coop-enforcement-origin">current origin</span>
     <li><span class="dfn-paneled" id="term-for-determining-navigation-params-policy-container">determine navigation params policy container</span>
     <li><span class="dfn-paneled" id="term-for-determining-the-origin">determine the origin</span>
     <li><span class="dfn-paneled" id="term-for-coop-enforce">enforce a response's cross-origin opener policy</span>
     <li><span class="dfn-paneled" id="term-for-environment">environment</span>
     <li><span class="dfn-paneled" id="term-for-environment-discarding-steps">environment discarding steps</span>
     <li><span class="dfn-paneled" id="term-for-navigation-params-sandboxing">final sandboxing flag set</span>
     <li><span class="dfn-paneled" id="term-for-forced-sandboxing-flag-set">forced sandboxing flag set</span>
     <li><span class="dfn-paneled" id="term-for-fully-active">fully active</span>
     <li><span class="dfn-paneled" id="term-for-navigation-params-has-cross-origin-redirects">has cross-origin redirects</span>
     <li><span class="dfn-paneled" id="term-for-navigation-params-hh">history handling</span>
     <li><span class="dfn-paneled" id="term-for-history-handling-behavior">history handling behavior</span>
     <li><span class="dfn-paneled" id="term-for-navigation-params-id">id <small>(for navigation params)</small></span>
     <li><span class="dfn-paneled" id="term-for-navigation-id">navigation id</span>
     <li><span class="dfn-paneled" id="term-for-navigation-pparams">navigation params</span>
     <li><span class="dfn-paneled" id="term-for-coop-enforcement-bcg-switch">needs a browsing context group switch</span>
     <li><span class="dfn-paneled" id="term-for-networking-task-source">networking task source</span>
     <li><span class="dfn-paneled" id="term-for-obtain-coop">obtain a cross-origin opener policy</span>
     <li><span class="dfn-paneled" id="term-for-concept-origin-opaque">opaque origin</span>
     <li><span class="dfn-paneled" id="term-for-navigation-params-origin">origin <small>(for navigation params)</small></span>
     <li><span class="dfn-paneled" id="term-for-parent-browsing-context">parent browsing context</span>
     <li><span class="dfn-paneled" id="term-for-navigation-params-policy-container">policy container <small>(for navigation params)</small></span>
     <li><span class="dfn-paneled" id="term-for-process-a-navigate-fetch">process a navigate fetch</span>
     <li><span class="dfn-paneled" id="term-for-process-a-navigate-response">process a navigate response</span>
     <li><span class="dfn-paneled" id="term-for-process-a-navigate-url-scheme">process a navigate url scheme</span>
     <li><span class="dfn-paneled" id="term-for-concept-relevant-global">relevant global object</span>
     <li><span class="dfn-paneled" id="term-for-relevant-settings-object">relevant settings object</span>
     <li><span class="dfn-paneled" id="term-for-navigation-params-request">request</span>
     <li><span class="dfn-paneled" id="term-for-navigation-params-reserved-environment">reserved environment</span>
     <li><span class="dfn-paneled" id="term-for-navigation-params-response">response</span>
     <li><span class="dfn-paneled" id="term-for-same-origin">same origin</span>
     <li><span class="dfn-paneled" id="term-for-sandboxing-flag-set">sandboxing flag set</span>
     <li><span class="dfn-paneled" id="term-for-concept-bc-sandboxing-flags">sandboxing flags</span>
     <li><span class="dfn-paneled" id="term-for-concept-environment-target-browsing-context">target browsing context</span>
     <li><span class="dfn-paneled" id="term-for-concept-task">task</span>
     <li><span class="dfn-paneled" id="term-for-top-level-browsing-context">top-level browsing context</span>
     <li><span class="dfn-paneled" id="term-for-concept-environment-top-level-creation-url">top-level creation url</span>
     <li><span class="dfn-paneled" id="term-for-concept-environment-top-level-origin">top-level origin</span>
     <li><span class="dfn-paneled" id="term-for-coop-enforcement-url">url</span>
     <li><span class="dfn-paneled" id="term-for-coop-struct-value">value</span>
     <li><span class="dfn-paneled" id="term-for-coop-enforcement-bcg-switch-report-only">would need a browsing context group switch due to report-only</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-set-append">append <small>(for set)</small></span>
     <li><span class="dfn-paneled" id="term-for-assert">assert</span>
     <li><span class="dfn-paneled" id="term-for-iteration-break">break</span>
     <li><span class="dfn-paneled" id="term-for-iteration-continue">continue</span>
     <li><span class="dfn-paneled" id="term-for-list-iterate">for each</span>
     <li><span class="dfn-paneled" id="term-for-struct-item">item</span>
     <li><span class="dfn-paneled" id="term-for-list">list</span>
     <li><span class="dfn-paneled" id="term-for-ordered-set">ordered set</span>
     <li><span class="dfn-paneled" id="term-for-list-remove">remove</span>
     <li><span class="dfn-paneled" id="term-for-string">string</span>
     <li><span class="dfn-paneled" id="term-for-struct">struct</span>
     <li><span class="dfn-paneled" id="term-for-set-union">union</span>
    </ul>
   <li>
    <a data-link-type="biblio">[referrer-policy]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-referrer-policy">referrer policy</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-concept-url-fragment">fragment</span>
     <li><span class="dfn-paneled" id="term-for-concept-url-origin">origin</span>
     <li><span class="dfn-paneled" id="term-for-concept-url-scheme">scheme</span>
     <li><span class="dfn-paneled" id="term-for-concept-url">url</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-csp3">[CSP3]
   <dd>Mike West. <a href="https://www.w3.org/TR/CSP3/"><cite>Content Security Policy Level 3</cite></a>. 29 June 2021. WD. URL: <a href="https://www.w3.org/TR/CSP3/">https://www.w3.org/TR/CSP3/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-hr-time-2">[HR-TIME-2]
   <dd>Ilya Grigorik. <a href="https://www.w3.org/TR/hr-time-2/"><cite>High Resolution Time Level 2</cite></a>. 21 November 2019. REC. URL: <a href="https://www.w3.org/TR/hr-time-2/">https://www.w3.org/TR/hr-time-2/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-referrer-policy">[REFERRER-POLICY]
   <dd>Jochen Eisinger; Emily Stark. <a href="https://www.w3.org/TR/referrer-policy/"><cite>Referrer Policy</cite></a>. 26 January 2017. CR. URL: <a href="https://www.w3.org/TR/referrer-policy/">https://www.w3.org/TR/referrer-policy/</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue">Does the prefetch record need to contain redirect info, e.g. to verify that all redirects would pass <code>navigate-to</code>? <a class="issue-return" href="#issue-794936c7" title="Jump to section">↵</a></div>
   <div class="issue">It might be possible to use cache response headers to determine when a response can be used multiple times, but given the short lifetime of the prefetch buffer it’s unclear whether this is worthwhile. <a class="issue-return" href="#issue-34917491" title="Jump to section">↵</a></div>
   <div class="issue">Is COOP enforcement needed on the prefetch path, too? <a class="issue-return" href="#issue-b4469747" title="Jump to section">↵</a></div>
   <div class="issue">Is CORP enforcement needed on the prefetch path, too? <a class="issue-return" href="#issue-cf0764a5" title="Jump to section">↵</a></div>
   <div class="issue">Check whether we need to expressly call Should request/response by blocked by Content Security Policy <a class="issue-return" href="#issue-eb60bbf4" title="Jump to section">↵</a></div>
   <div class="issue">Check Service Worker integration <a class="issue-return" href="#issue-1ea0021d" title="Jump to section">↵</a></div>
   <div class="issue">It might be possible to "downgrade" to <a data-link-type="dfn" href="#uncredentialed-prefetch">uncredentialed prefetch</a> in this case. <a class="issue-return" href="#issue-a3686c91" title="Jump to section">↵</a></div>
   <div class="issue">This ends up setting the <code>`Cache-Control`</code> and <code>`Pragma`</code> request headers, which is contrary to what Chromium does today when skipping cache here. One approach would be to add a flag similar to <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#no-cache-prevent-cache-control">prevent no-cache cache-control header modification flag</a>. It would also be possible to have a cache that can be copied into the ordinary cache, like Chromium does for cookies. <a class="issue-return" href="#issue-239df98e" title="Jump to section">↵</a></div>
   <div class="issue">This does not fully address cookie isolation or migration (somewhat complicated by <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> not dealing with it), and similar measures with authorization entries, TLS client certificates, and connection pools. This is currently complicated by the fact that even those that are covered by the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#network-partition-key">network partition key</a> are difficult to address while it’s not possible to further partition. <a class="issue-return" href="#issue-d45eff4c" title="Jump to section">↵</a></div>
   <div class="issue">Update this to include the <code>`Supports-Loading-Mode`</code> mechanism to allow responses to continue despite cookies. <a class="issue-return" href="#issue-414cc665" title="Jump to section">↵</a></div>
   <div class="issue">Further review is needed of the cookies-present handling and its interaction with redirects and caches. <a class="issue-return" href="#issue-cdd1a31a" title="Jump to section">↵</a></div>
  </div>
  <aside class="dfn-panel" data-for="prefetch-buffer">
   <b><a href="#prefetch-buffer">#prefetch-buffer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-prefetch-buffer">1. Concepts</a> <a href="#ref-for-prefetch-buffer①">(2)</a> <a href="#ref-for-prefetch-buffer②">(3)</a> <a href="#ref-for-prefetch-buffer③">(4)</a> <a href="#ref-for-prefetch-buffer④">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="prefetch-record">
   <b><a href="#prefetch-record">#prefetch-record</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-prefetch-record">1. Concepts</a> <a href="#ref-for-prefetch-record①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="prefetch-record-url">
   <b><a href="#prefetch-record-url">#prefetch-record-url</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-prefetch-record-url">1. Concepts</a> <a href="#ref-for-prefetch-record-url①">(2)</a> <a href="#ref-for-prefetch-record-url②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="prefetch-record-referrer-policy">
   <b><a href="#prefetch-record-referrer-policy">#prefetch-record-referrer-policy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-prefetch-record-referrer-policy">1. Concepts</a> <a href="#ref-for-prefetch-record-referrer-policy①">(2)</a> <a href="#ref-for-prefetch-record-referrer-policy②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="prefetch-record-response">
   <b><a href="#prefetch-record-response">#prefetch-record-response</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-prefetch-record-response">1. Concepts</a> <a href="#ref-for-prefetch-record-response①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="prefetch-record-expiry-time">
   <b><a href="#prefetch-record-expiry-time">#prefetch-record-expiry-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-prefetch-record-expiry-time">1. Concepts</a> <a href="#ref-for-prefetch-record-expiry-time①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="store-a-prefetch-record">
   <b><a href="#store-a-prefetch-record">#store-a-prefetch-record</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-store-a-prefetch-record">3. Prefetch algorithms</a> <a href="#ref-for-store-a-prefetch-record①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="perform-a-common-navigational-fetch">
   <b><a href="#perform-a-common-navigational-fetch">#perform-a-common-navigational-fetch</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-perform-a-common-navigational-fetch">2. HTML Patches</a>
    <li><a href="#ref-for-perform-a-common-navigational-fetch①">3. Prefetch algorithms</a> <a href="#ref-for-perform-a-common-navigational-fetch②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="list-of-sufficiently-strict-speculative-navigation-referrer-policies">
   <b><a href="#list-of-sufficiently-strict-speculative-navigation-referrer-policies">#list-of-sufficiently-strict-speculative-navigation-referrer-policies</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-of-sufficiently-strict-speculative-navigation-referrer-policies">3. Prefetch algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="uncredentialed-prefetch">
   <b><a href="#uncredentialed-prefetch">#uncredentialed-prefetch</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-uncredentialed-prefetch">3. Prefetch algorithms</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>
<script>/* script-var-click-highlighting */

    document.addEventListener("click", e=>{
        if(e.target.nodeName == "VAR") {
            highlightSameAlgoVars(e.target);
        }
    });
    {
        const indexCounts = new Map();
        const indexNames = new Map();
        function highlightSameAlgoVars(v) {
            // Find the algorithm container.
            let algoContainer = null;
            let searchEl = v;
            while(algoContainer == null && searchEl != document.body) {
                searchEl = searchEl.parentNode;
                if(searchEl.hasAttribute("data-algorithm")) {
                    algoContainer = searchEl;
                }
            }

            // Not highlighting document-global vars,
            // too likely to be unrelated.
            if(algoContainer == null) return;

            const algoName = algoContainer.getAttribute("data-algorithm");
            const varName = getVarName(v);
            const addClass = !v.classList.contains("selected");
            let highlightClass = null;
            if(addClass) {
                const index = chooseHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] += 1;
                indexNames.set(algoName+"///"+varName, index);
                highlightClass = nameFromIndex(index);
            } else {
                const index = previousHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] -= 1;
                highlightClass = nameFromIndex(index);
            }

            // Find all same-name vars, and toggle their class appropriately.
            for(const el of algoContainer.querySelectorAll("var")) {
                if(getVarName(el) == varName) {
                    el.classList.toggle("selected", addClass);
                    el.classList.toggle(highlightClass, addClass);
                }
            }
        }
        function getVarName(el) {
            return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
        }
        function chooseHighlightIndex(algoName, varName) {
            let indexes = null;
            if(indexCounts.has(algoName)) {
                indexes = indexCounts.get(algoName);
            } else {
                // 7 classes right now
                indexes = [0,0,0,0,0,0,0];
                indexCounts.set(algoName, indexes);
            }

            // If the element was recently unclicked,
            // *and* that color is still unclaimed,
            // give it back the same color.
            const lastIndex = previousHighlightIndex(algoName, varName);
            if(indexes[lastIndex] === 0) return lastIndex;

            // Find the earliest index with the lowest count.
            const minCount = Math.min.apply(null, indexes);
            let index = null;
            for(var i = 0; i < indexes.length; i++) {
                if(indexes[i] == minCount) {
                    return i;
                }
            }
        }
        function previousHighlightIndex(algoName, varName) {
            return indexNames.get(algoName+"///"+varName);
        }
        function nameFromIndex(index) {
            return "selected" + index;
        }
    }
    </script>